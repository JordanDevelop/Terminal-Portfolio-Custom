var marmottajax=function(t){return marmottajax.get(t)};marmottajax.normalize=function(t){return!!t&&("string"==typeof t?{url:t}:t)},marmottajax.json=function(t){if(t=marmottajax.normalize(t))return t.json=!0,new marmottajax.request(t)},marmottajax.get=function(t){return new marmottajax.request(t)},marmottajax.post=function(t){if(t=marmottajax.normalize(t))return t.method="POST",new marmottajax.request(t)},marmottajax.put=function(t){if(t=marmottajax.normalize(t))return t.method="PUT",new marmottajax.request(t)},marmottajax.delete_=function(t){if(t=marmottajax.normalize(t))return t.method="DELETE",new marmottajax.request(t)},marmottajax.request=function(t){if(!t)return!1;if("string"==typeof t&&(t={url:t}),"POST"===t.method||"PUT"===t.method||"DELETE"==t.method){var r="?";for(var e in t.options)r+=t.options.hasOwnProperty(e)?"&"+e+"="+t.options[e]:""}else{t.method="GET",t.url+=t.url.indexOf("?")<0?"?":"";for(var e in t.options)t.url+=t.options.hasOwnProperty(e)?"&"+e+"="+t.options[e]:""}if(this.xhr=null,window.XMLHttpRequest&&(this.xhr=new XMLHttpRequest),window.ActiveXObject){var a=["Msxml2.XMLHTTP.6.0","Msxml2.XMLHTTP.3.0","Msxml2.XMLHTTP","Microsoft.XMLHTTP"];for(var n in a)try{this.xhr=new ActiveXObject(a[n]);break}catch(t){}}if(!this.xhr)throw"xhr not supported";this.xhr.options=t,this.xhr.callbacks={then:[],error:[]},this.then=function(t){return this.xhr.callbacks.then.push(t),this},this.error=function(t){return this.xhr.callbacks.error.push(t),this},this.xhr.call=function(t,r){for(var e=0;e<this.callbacks[t].length;e++)"function"==typeof this.callbacks[t][e]&&this.callbacks[t][e](r)},this.xhr.returnSuccess=function(t){this.call("then",t)},this.xhr.returnError=function(t){this.call("error",t)},this.xhr.onreadystatechange=function(){if(4===this.readyState&&200==this.status){var t=this.responseText;if(this.options.json)try{t=JSON.parse(t)}catch(t){return this.returnError("invalid json"),!1}this.returnSuccess(t)}else 4===this.readyState&&404==this.status?this.returnError("404"):4===this.readyState&&this.returnError("unknow")},this.xhr.open(t.method,t.url,!0),this.xhr.setRequestHeader("Content-type","application/x-www-form-urlencoded"),this.xhr.send("undefined"!=typeof r?r:null)};